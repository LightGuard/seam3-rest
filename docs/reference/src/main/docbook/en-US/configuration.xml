<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE chapter PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN"
   "http://www.oasis-open.org/docbook/xml/4.5/docbookx.dtd" []>
<chapter id="resteasy.configuration">
	<title>Configuration</title>
	<para>
		The RESTEasy framework provides various configuration options used to adjust its behavior. When using plain RESTEasy, these options can be set using servlet context parameters.
	</para>
	
	<para>
		The Seam RESTEasy module provides an alternative way of configuration. The entire
		configuration is optional and it is not necessary to configure
		anything for an application to run. However, once the application needs to be tuned, 
		the programmatic or XML configuration are easier to deal with compared to
		setting servlet context parameters.
	</para>

	<para>
		The following configuration options are supported:
	</para>

	<table id="resteasy.configuration.conf-options-table">
	  <title>Seam RESTEasy Configuration Options</title>
		<tgroup cols='2'>
			<thead>
				<row>
					<entry>Configuration option</entry>
					<entry>Description</entry>
				</row>
			</thead>
			<tbody>
				<row>
					<entry>resources</entry>
					<entry>JAX-RS resources that are registered with RESTEasy
					</entry>
				</row>
				<row>
					<entry>excludedResources</entry>
					<entry>JAX-RS resources which are registered by default, (i.e. by
						automated classpath scanning) but are excluded from the installation
					</entry>
				</row>
				<row>
					<entry>mediaTypeMappings</entry>
					<entry>Used to override value of the <literal>Accept</literal> HTTP header using value from URI suffixes (e.g. <literal>.xml</literal>)</entry>
				</row>
				<row>
					<entry>languageMappings</entry>
					<entry>Used to override value of the <literal>Accept-Language</literal> HTTP header using value from URI suffixes (e.g. <literal>.de</literal>)</entry>
				</row>
				<row>
					<entry>exceptionMappings</entry>
					<entry>Exception type to HTTP response bindings. For more information about exception mapping, refer to <xref linkend="resteasy.exception.mapping"/></entry>
				</row>
				<row>
					<entry>registerValidationExceptionMapper</entry>
					<entry>Enables/Disables the Bean Validation exception mapper. For more information about Bean Validation integration, refer to <xref linkend="resteasy.validation"/></entry>
				</row>
			</tbody>
		</tgroup>
	</table>

	<sect1>
		<title>Programatic configuration</title>
		<para>
			The first possible approach is to configure the application in
			Java. This can be done by specializing the default
			<literal>SeamResteasyConfiguration</literal> bean as shown in the following example:
		</para>

		<example>
			<title>CustomSeamResteasyConfiguration.java</title>
			<programlisting role="JAVA"><![CDATA[@Specializes
public class CustomSeamResteasyConfiguration extends SeamResteasyConfiguration
{
  @PostConstruct
  public void setup()
  {
     addResource(TestResource.class); // add a JAX-RS resource
     addProvider(TestProvider.class); // add a JAX-RS provider
     addMediaTypeMapping("xml", "application/xml"); // bind any URI with ".xml" suffix to the "application/xml" media type
  }
}]]></programlisting>
		</example>
	</sect1>

	<sect1>
		<title>XML configuration</title>
		<para>
			An alternative and more practical way of configuration is to use the seam-xml
			module
			and configure
			the application using an XML descriptor. 
		</para>
		<para>
			Firstly, the seam-xml module needs to be added to the application. If
			using maven,
			this can be done by specifying the following dependency:
		</para>

		<example>
			<title>seam-xml dependency added to the pom.xml file.</title>
			<programlisting role="XML"><![CDATA[<dependency> 
	<groupId>org.jboss.seam.xml</groupId> 
	<artifactId>seam-xml-config</artifactId> 
	<version>${seam.xml.version}</version> 
</dependency>]]></programlisting>
		</example>

		<para>
			For more information on the seam-xml module, refer to the
			<ulink url="http://docs.jboss.org/seam/3/xml-config/latest/reference/en-US/html_single/">seam-xml reference documentation</ulink>
			Once the seam-xml module is added, specify the configuration in the <literal>seam-beans.xml</literal> file, located in the
			<literal>WEB-INF</literal>
			or
			<literal>META-INF</literal>
			folder
			of the web archive.
		</para>

		<example>
			<title>Seam RESTEasy configuration in the seam-beans.xml configuration file.</title>
			<programlistingco>
				<areaspec>
					<area id="resteasy-configuration-resource" coords="5" />
					<area id="resteasy-media-type-mapping" coords="9" />
					<area id="resteasy-exception-mapping" coords="14" />
				</areaspec>
			<programlisting><![CDATA[<beans xmlns:s="urn:java:ee" xmlns:resteasy="urn:java:org.jboss.seam.resteasy.configuration"> 
	<resteasy:SeamResteasyConfiguration registerValidationExceptionMapper="true"> 
		<s:replaces/> 
		
		<resteasy:excludedResources>
			<s:value>com.example.TestResource</s:value>
		</resteasy:excludedResources>
		 
		<resteasy:mediaTypeMappings>
			<s:entry key="xml" value="application/xml"/>
			<s:entry key="json" value="application/json"/>
		</resteasy:mediaTypeMappings>
		
		<resteasy:exceptionMappings>
			<s:value>
				<resteasy:ExceptionMapping exceptionType="javax.persistence.NoResultException" statusCode="404">
					<resteasy:message>Requested resource does not exist.</resteasy:message>
				</resteasy:ExceptionMapping>
			</s:value>
		</resteasy:exceptionMappings>
	</resteasy:SeamResteasyConfiguration> 
</beans>]]></programlisting>
				<calloutlist>
					<callout arearefs="resteasy-configuration-resource">
						<para>
							The <literal>TestResource</literal> is excluded from the deployment (e.g. the production environment).
            			</para>
					</callout>
					<callout arearefs="resteasy-media-type-mapping">
						<para>
							Media type mappings are set.
            			</para>
					</callout>
					<callout arearefs="resteasy-exception-mapping">
						<para>
							An exception mapping is set.
            			</para>
					</callout>
				</calloutlist>
			</programlistingco>
		</example>
		
	</sect1>
</chapter>